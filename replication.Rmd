---
title: "Replication Paper: 'Identifying voter preferences for politicians’ personal attributes: a conjoint experiment in Japan'"
author: "Evelyn Cai"
date: "5/8/2020"
output:
  bookdown::pdf_document2:
    includes:  
      in_header: Header/my_header.tex
    keep_tex: true
    toc: true
header-includes:
    - \usepackage{setspace}\doublespacing
    - \usepackage{float}
spacing: double
indent: true
fontsize: 12
geometry: margin=1in
Bibliogrpahy: \singlespacing
abstract: \singlespacing Horiuchi, Smith, and Yamamoto (2020) found through differences between observational data and their conjoint survey results that Japanese voters\' voting preferences are dependent on external factors. The conjoint survey results yielded consistent voter preferences across different levels of knowledge on electoral systems; however, observational data shows that voters\' preferences are not consistent in different electoral systems. I was able to successfuly replicate these results and findings. My extension focuses on examining the difference in marginal means instead of the difference of average marginal component effects, which can change the treatment effect estimate.
bibliography: ["Bib-files/conjoint-method.bib", "Bib-files/japan.bib", "Bib-files/salience.bib", "Bib-files/gender.bib", "Bib-files/electoral.bib", "Bib-files/leeper.bib", "Bib-files/R.bib", "Bib-files/tidyverse.bib"]
biblio-style: "apalike"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Load necessary libraries

library(tidyverse)
library(utils)
library(ggmosaic)
library(ggplot2)
library(cregg)
library(tinytex)
library(bookdown)
library(gt)
library(gtsummary)
library(corrplot)
library(patchwork)

# Decompress the file (Commented out because already completed once)
# untar(tarfile = "ReplicationPackage (1).tar.gz")

# Read in .csv files as dataframes

DD_lo <- read_csv("Data/actual-lower-2014-allcandidates.csv")
DD_up <- read_csv("Data/actual-upper-2013-allcandidates.csv")

# Create bibliography files, commented out because already did so

# knitr::write_bib("knitr", "japan.bib", width = 60)
# knitr::write_bib("knitr", "conjoint-method.bib", width = 60)

```

```{r pre_processing_data, include = FALSE}

### Recoding Variables

## System type indicators

# Create a new column called win_type_1 that encodes the results from the
#DD_lo$result column.

DD_lo <- DD_lo %>%
  mutate(win_type_1 = as.factor(case_when(result == 1 ~ "SMD",
                                result == 2 ~"Zombie",
                                result == 3 ~ "PR",
                                TRUE ~ NA_character_)),
         elec_type_1 = case_when(prcode == 0 ~ "SMD",
                                 kucode == 0 ~ "PR",
                                 TRUE ~ "Both"),
         elec_type_2 = as.factor(case_when(elec_type_1 == "SMD" | elec_type_1 == "Both" ~ "SMD/Dual",
                                 TRUE ~ elec_type_1)))


DD_up <- DD_up %>%
  mutate(win_type_1 = as.factor(districttype),
         elec_type_1 = win_type_1,
         win_type_2 = as.factor(case_when(win_type_1 == "SMD" | win_type_1 == "MMD" ~ "SNTV",
                                win_type_1 == "PR" ~ "PR",
                                TRUE ~ NA_character_)),
         elec_type_2 = win_type_2)

# Recode values

DDD <- list(DD_lo, DD_up)

for(i in 1:length(DDD))
  {DD <- DDD[[i]] %>%
    mutate(win = case_when(result > 0 ~ 1,
                           TRUE ~ 0),
           celeb = as.factor(case_when(celeb == 0 ~ "No",
                                       celeb == 1 ~ "Yes",
                                       TRUE ~ NA_character_)),
           busi_emp = as.factor(case_when(busi_emp == 0 ~ "No",
                                          busi_emp == 1 ~ "Yes",
                                          TRUE ~ NA_character_)),
           busi_exec = as.factor(case_when(busi_exec == 0 ~ "No",
                                           busi_exec == 1 ~ "Yes",
                                           TRUE ~ NA_character_)),
           bcrat = as.factor(case_when(bcrat == 0 ~ "No",
                                       bcrat == 1 ~ "Yes",
                                       TRUE ~ NA_character_)),
           localbcrat = as.factor(case_when(localbcrat == 0 ~ "No",
                                            localbcrat == 1 ~ "Yes",
                                            TRUE ~ NA_character_)),
           pref_assy = as.factor(case_when(pref_assy == 0 ~ "No",
                                           pref_assy == 1 ~ "Yes",
                                           TRUE ~ NA_character_)),
           sec = as.factor(case_when(sec == 0 ~ "No",
                                     sec == 1 ~ "Yes",
                                     TRUE ~ NA_character_)),
           experience_lab = as.character(experience_lab),
           experience_lab = factor(experience_lab, levels = c("Currently in office, 3+ terms", "Currently in office, 2 terms", "Currently in office, 1 term", "Formerly in office, 3+ terms", "Formerly in office, 2 terms", "Formerly in office, 1 term", "No experience")),
           age_lab = as.character(case_when(age < 40 ~ "Under 40",
                                         age >= 40 & age < 60 ~ "50 - 59",
                                         age >= 60 & age < 70 ~ "60 - 69",
                                         age >= 70 ~ "70 or over",
                                         TRUE ~ NA_character_)),
           age_lab = factor(age_lab, levels = c("70 or over", "60 - 69", "50 - 59", "Under 40")),
           educ_lab = as.factor(case_when(educ_lab == "Local public university" ~ "Other public university",
                                          TRUE ~ educ_lab)),
           party_en = factor(party_en, levels = c("LDP", "Komeito", "JCP", "DPJ")),
           home_lab = factor(home_lab, ordered = TRUE),
           dynastic_lab = as_factor(case_when(dynastic_lab == "Local-level elected politician" ~ "Loc. Pol.",
                                              dynastic_lab == "National-level elected politician" ~ "MP",
                                              dynastic_lab == "Cabinet minister" ~ "Cab. Min.",
                                              TRUE ~ "None")))
           DDD[[i]] <- DD
}

# Unlist

DD_lo <- DDD[[1]]
DD_up <- DDD[[2]]

# Reorder Levels

# lower house
DD_lo %>%
  mutate(party_en = factor(party_en, levels = c("Independent","Other","PFG","JIP","LDP","Komeito","DPJ","PLP","SDP","JCP")))

# upper house
DD_up %>%
  mutate(party_en = factor(party_en, levels = c("Independent","Other","JIP","LDP","Komeito","DPJ","PLP","SDP","JCP")))

## Filter for winners

DD_lo_win <- DD_lo %>%
  filter(win == 1)

DD_up_win <- DD_up %>%
  filter(win == 1)
```

\pagebreak

## Introduction


In Yusaku Horiuchi, Teppei Yamamoto and Daniel Smith's (2020) paper *Identifying voter preferences for politicians’ personal attributes: a conjoint experiment in Japan*, they examined observational data from Japanese political candidates and conducted a conjoint survey experiment to determine Japanese voters' attribute preferences and under which circumstances they can be altered. They also explored the effect of a candidate's gender on their electability likelihood and its interaction with other variables, such as awareness of Japan's electoral groups. While it is commonly established that the personal attributes of political candidates do have an impact on voter choice, as they portray in their literature review, they also highlight the fact that certain traits' interaction effects may provide for an explanation for why candidates were chosen (@R-yamamoto). For example, men were "awarded" more for political experience than women, which may explain the severe lack of female representation despite the consistency in gender preferences from the conjoint survey (@R-yamamoto). They conducted conjoint analyses involving Average Marginal Component Effects (AMCEs) and Average Component Interaction Effects (ACIEs) to determine the effect of different variables on candidate selection likelihood, and whether said variables interacted with each othe in which ways.



In replicating their paper and conducting data analysis, I used R, an open source programming language (@R). All of Horiuchi, Smith, & Yamamoto's code has been generously made available through the Dataverse.^[Horiuchi, Yusaku; Smith, Daniel M.; Yamamoto, Teppei, 2018, "Replication Data for: Identifying Voter Preferences for Politicians' Personal Attributes: A Conjoint Experiment in Japan", https://doi.org/10.7910/DVN/KCIADO, Harvard Dataverse, V1] All analysis that I have conducted in this exercise can be found at the working Github repository.^[Working repository can be found here: https://github.com/caievelyn/voter_preferences_replication]



With the available code through Dataverse, I was able to replicate the main findings of the paper, which display the AMCEs of different candidate features. The Appendix (see section 0.6) features additional ACIE plots, as well as the mosaic and co-correlation matrices. Charts not include in this replication are additional mosaic plots; the original Appendix had many based off of variables other than age and gender. Similarly, many additional ACIE plots charted the relationship between dynastic politicans and other variables. In the author's original paper and appendix, plots that display analyses using observational data are also present. Diving deeper into the gap between the experimental and observation data, I applied Leeper *et al.*'s (2019) `cregg` package to the dataset, calculating and displaying the marginal means rather than AMCEs (@leeper). Marginal means are useful because they avoid setting an arbitrary baseline for comparison, as opposed to AMCEs. This application is significant because the adjusted treatment effect estimates are likely different and could be significantly so.



## Literature Review



Horiuchi, Smith, & Yamamoto (2020) were also interested in the complexities introduced by the interaction between desired personal attributes and characteristics of election systems. For example, Rule and Zimmerman (1994) found that proportional representation (PR) systems tended to do better in terms of gender parity than first-pass-the-post systems (@gender). Additionally, systems that emphasize voting for a candidate as opposed to voting for a party lend more salience to candidates’ personal attributes, giving their attributes’ desirability (or lack thereof) more weight in the eyes of the voter (@R-salience). As such, Horiuchi et al. (2020) wanted to tease out this relationship: Did Japanese voters really prefer male candidates over female candidates at the baseline, or was this preference influenced by characteristics of the system?



Japan is a useful case study because of its high “intra-country variation” in electoral systems (@electoral). Four different electoral systems encompass varying geographical areas, and in addition, voters can vote for a candidate, a party, or both, depending on the system (@R-yamamoto). Horiuchi, Smith, & Yamamoto (2020) tested for whether knowledge of said electoral systems would impact voter preferences using a randomly assigned experiment, and found that there were consistent indications of voter preferences among respondents who were primed with knowledge on different electoral systems, but no significant differences were noted between the SNTV tier and PR tier of the House of Councillors, or the SMD and PR tiers of the House of Representatives, which was a surprising finding (@R-yamamoto). They conducted a conjoint survey, in which different candidate attributes were completely randomized and presented for a participant to choose the candidate of their choice. This method of conjoint experiments as applied to political science was popularized by Hainmueller *et al.* (@R-conjointmethod). Another method employed in the replication paper was compared observational data of actual politicians to the conjoint experiment results. This comparison revealed that the actual representatives in Japan’s parliament are very different from the “ideal” candidates of the participants, demonstrating that other variables that weren’t captured in the conjoint experiment play a large role in elections, such as party candidate recruitment systems (@R-yamamoto).



Horiuchi, Smith, & Yamamoto (2020) also checked the conjoint data against the actual data of real elected politicians and drew conclusions from the similarities and differences expressed in terms of preferred candidate attributes. Additionally, there were controls for knowledge priming in their conjoint experiment. Participants were assigned different priming treatments, each of which would provide information on one electoral system's rules They found that there was only one of 56 statistically significant differences in attribute preferences. However, interestingly enough, the actual observations of elected candidates do reveal that there is a discrepancy in the type of candidate elected when constituents are aware of how electoral systems function versus when they are unaware. To parse out the interaction effects of features such as experience and age with the gender variable, the authors calculated ACIEs for the gender variable. The results are displayed below, and reveal that male and female candidates are in fact rewarded/ punished differently based on gender. This finding facilitated the authors' conclusion that external factors, such as party recruitment tactics, are key in influencing voter preferences, rather than electoral systems directly influencing voter preferences as a nature of their configurations.

```{r conjoint_data, include = FALSE, cache = TRUE}

# Load data file
load("Data/conjoint.RData")

# Rename the volumns with multiple strings for names, which confuses cj()
DD <- DD %>%
  rename("Education" = `Highest Educational Attainment`,
         "Previous_Occupation" = `Prior Occupation`,
         "Parent_Political_Background" = `Parental Political Background`)

#Recode the levels for parental political background, because duplicated level
#labels aren't compatible with cj.
DD <- DD %>%
  mutate(Parent_Political_Background = case_when(Parent_Political_Background == "None" ~ "None",
                                                 Parent_Political_Background == "National assembly member" ~ "National Assembly Member",
                                                 Parent_Political_Background == "Prefectural assembly member" ~ "Prefectural Assembly Member",
                                                 Parent_Political_Background == "Cabinet minister" ~ "Cabinet Minister")) %>%
  # Refactor experience and party
  mutate(Experience = fct_relevel(Experience, "No experience", "Formerly in office, 1", "Currently in office, 1", "Formerly in office, 2", "Currently in office, 2", "Formerly in office, 3+", "Currently in office, 3+"),
         Party = fct_relevel(Party, "Independent", "DPJ", "JCP", "Komeito", 
                                          "LDP"))
         

# Create character string to rename y axis.

y_labs <- rev(c("Age:", "(Baseline = 30)", "42", "57", "64", "79",
            "Experience:", "(Baseline = No experience)", "Formerly in office, 1 term", "Currently in office, 1 term", "Formerly in office, 2 terms", "Currently in office, 2 terms", "Formerly in office, 3+ terms", "Currently in office, 3+ terms", 
            "Highest Educational Attainment:", "(Baseline = High school)", "Local public university", "Prestigious private university", "University of Tokyo", 
            "Hometown:", "(Baseline = Inside)", "Outside",
            "Party:", "(Baseline = Independent)", "DPJ", "JCP", "Komeito", "LDP",
            "Prior Occupation:", "(Baseline = company employee)", "Business executive", "Celebrity", "Local government employee", "National government employee", "Prefectural assembly member", "Prefectural governor"))

# Create string to create the y axis label bold pattern. Boldpattern1
# corresponds to Marginal Means, Difference in marginal means graphs, and the
# AMCE graphs. The difference in AMCE graph is represented by boldpattern2,
# because all baseline values have been removed.

boldpattern <- rev(c('bold', 'plain', 'plain', 'plain', 'plain', 'plain',
                 'bold', 'plain', 'plain', 'plain', 'plain', 'plain', 'plain', 'plain',
                 'bold', 'plain', 'plain', 'plain', 'plain',
                 'bold', 'plain', 'plain',
                 'bold', 'plain', 'plain', 'plain', 'plain', 'plain',
                 'bold', 'plain', 'plain', 'plain', 'plain', 'plain', 'plain', 'plain'))

boldpattern2 <- rev(c('bold', 'plain', 'plain', 'plain', 'plain', 
                 'bold', 'plain', 'plain', 'plain', 'plain', 'plain', 'plain',
                 'bold', 'plain', 'plain', 'plain',
                 'bold', 'plain',
                 'bold', 'plain', 'plain', 'plain', 'plain',
                 'bold', 'plain', 'plain', 'plain', 'plain', 'plain', 'plain'))

DD_cj <- cj(DD,
            formula = Y.1 ~ Age + Experience + Education + Hometown + Party + Previous_Occupation,
            estimate = "amce",
            level_order = c("descending"),
            by = ~Gender)

DD_diff <- cj(DD,
              formula = Y.1 ~ Age + Experience + Education + Hometown + Party + Previous_Occupation,
              estimate = "amce_differences",
              level_order = c("descending"),
              by = ~Gender)

x <- plot(rbind(DD_cj, DD_diff)) +
  ggplot2::facet_wrap(~BY, ncol = 3L) +
  ggplot2::labs(title = "AMCE by Gender",
                caption = "Data from Horiuchi, Smith, & Yamamato via Dataverse") +
  theme_minimal() +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.text = element_text(size=10),
        panel.background = element_rect(fill = "gray95",
                                        colour = "gray95",
                                        size = 2,
                                        linetype = "solid"),
        panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"), 
        panel.grid.minor = element_line(size = 0.5, linetype = 'solid', colour = "white"),
    axis.text.y = element_text(face = boldpattern)) +
  scale_x_continuous(seq(-.3, .1, by = 0.1), labels = c("-.3", "-.2", "-.1", "0", ".1")) +
  scale_y_discrete(labels = y_labs) +
  geom_point(size=1.75) +
  geom_vline(xintercept = 0, linetype="dotted", color = "red")
```

```{r display, echo = FALSE, warning = FALSE, fig.height = 8.5, fig.width = 10, fig.cap = "The first two columns on the left display the average treatment effects for different variables, keeping the gender of the candidate constant. The third column displays the difference in average treatment effect, subtracting that of males to that of females. As you can see, party and age have large effects on candidate selection. However, when taking the different in AMCEs, there is no substantial difference between traits that are desired in male and female candidates. The average treatment effect can be interpreted as the 'boost' a certain characteristic gives a candidate; negative values indicate hurting the candidate's chances of being chosen, while positive values reflect desirable traits."}

# I used warning=FALSE because running the ggplot2 code gives me the following error: " Warning: Removed 18 rows containing missing values (geom_point)". These 'missing points' simply correspond to the variable titles (Age, Gender, etc). It makes sense that there are no points because those feature labels are just labels, and do not contain any data points. However, the levels within each feature do contain data points. You will find I use warning = FALSE in other chunks that run ggplot2 code, and I refer back to this explanation.

# Display the plot

x
```


## Replication 

Thanks to the available data and code, written primarily in base R, I was able to replicate the main findings. The area I failed to replicate was the AMCE calculations of "Parent Political Background." A warning message displayed whenever I attempted to calculate AMCEs for this variable, indicating that my recoding of that variable could have been faulty; however, I could not track down the cause of this error. Ultimately, I chose to omit this variable from my calculations and display, as the original paper shows that none of the feature levels are significant at the 95% level. However, in the future, exploring why this one variable seemed to be incompatible with AMCE calculation functions would be very helpful and contribute to more accurate replications. I also utilized tools from the `tidyverse` library. Tidyverse is a library that consolidates various open-source packages, which make data cleaning, analysis, and visualization much easier (@tidyverse). For example, in constructing the conjoint analyses plots, I utilized the `cregg` package developed by Thomas Leeper, which automatically combines the calculation of AMCEs, MMs, and more, with `ggplot2` plotting functionalities. Thank you to the authors for their clean, easily replicable code!

```{r priming_amce, include = FALSE, cache = TRUE}

# Subset for SNTV, PR (upper) and SMD, PR tiers (lower)

upper <- DD %>%
  filter(house == "upper") %>%
  mutate(dist = case_when(dist == TRUE ~ "SNTV Tier",
                          TRUE ~ "PR Tier"))

lower <- DD %>%
  filter(house == "lower") %>%
  mutate(dist = case_when(dist == TRUE ~ "SMD Tier",
                          TRUE ~ "PR Tier"))

# Calculate AMCEs and differences for each of the HC and HR
upper_amce <- cj(upper,
            formula = Y.1 ~ Age + Experience + Gender + Education + Hometown + Party + Previous_Occupation,
            estimate = "amce",
            level_order = c("descending"),
            by = ~dist)

upper_diff <- cj(upper,
              formula = Y.1 ~ Age + Experience + Gender + Education + Hometown + Party + Previous_Occupation,
              estimate = "amce_differences",
              level_order = c("descending"),
              by = ~dist)
lower_amce <- cj(lower,
            formula = Y.1 ~ Age + Experience + Gender + Education + Hometown + Party + Previous_Occupation,
            estimate = "amce",
            level_order = c("descending"),
            by = ~dist)

lower_diff <- cj(lower,
              formula = Y.1 ~ Age + Experience + Gender + Education + Hometown + Party + Previous_Occupation,
              estimate = "amce_differences",
              level_order = c("descending"),
              by = ~dist)

# Create character vectors to label the AMCEs per priming group, which differs
# from previously defined vectors in its inclusion of gender.

y_labs3 <- rev(c("Age:", "(Baseline = 30)", "42", "57", "64", "79",
            "Experience:", "(Baseline = No experience)", "Formerly in office, 1 term", "Currently in office, 1 term", "Formerly in office, 2 terms", "Currently in office, 2 terms", "Formerly in office, 3+ terms", "Currently in office, 3+ terms",
            "Gender:", "(Baseline = Male)", "Female",
            "Highest Educational Attainment:", "(Baseline = High school)", "Local public university", "Prestigious private university", "University of Tokyo", 
            "Hometown:", "(Baseline = Inside)", "Outside",
            "Party:", "(Baseline = Independent)", "DPJ", "JCP", "Komeito", "LDP",
            "Prior Occupation:", "(Baseline = company employee)", "Business executive", "Celebrity", "Local government employee", "National government employee", "Prefectural assembly member", "Prefectural governor"))

boldpattern3 <- rev(c('bold', 'plain', 'plain', 'plain', 'plain', 'plain',
                 'bold', 'plain', 'plain', 'plain', 'plain', 'plain', 'plain', 'plain',
                 'bold', 'plain', 'plain',
                 'bold', 'plain', 'plain', 'plain', 'plain',
                 'bold', 'plain', 'plain',
                 'bold', 'plain', 'plain', 'plain', 'plain', 'plain',
                 'bold', 'plain', 'plain', 'plain', 'plain', 'plain', 'plain', 'plain'))

priming_upper <- plot(rbind(upper_amce, upper_diff)) +
  ggplot2::facet_wrap(~BY, ncol = 3L) +
  ggplot2::labs(title = "AMCEs and differences for the House of Councillors") +
  theme_minimal() +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.text = element_text(size=10),
        panel.background = element_rect(fill = "gray95",
                                        colour = "gray95",
                                        size = 2,
                                        linetype = "solid"),
        panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"), 
        panel.grid.minor = element_line(size = 0.5, linetype = 'solid', colour = "white"),
    axis.text.y = element_text(face = boldpattern3)) +
  scale_x_continuous(seq(-.3, .1, by = 0.1), labels = c("-.3", "-.2", "-.1", "0", ".1")) +
  scale_y_discrete(labels = y_labs3) +
  geom_point(size=1.75) +
  geom_vline(xintercept = 0, linetype="dotted", color = "red")

priming_lower <- plot(rbind(lower_amce, lower_diff)) +
  ggplot2::facet_wrap(~BY, ncol = 3L) +
  ggplot2::labs(title = "AMCEs and differences for the House of Representatives",
                caption = "Data from Horiuchi, Smith, & Yamamato via Dataverse") +
  theme_minimal() +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.text = element_text(size=10),
        panel.background = element_rect(fill = "gray95",
                                        colour = "gray95",
                                        size = 2,
                                        linetype = "solid"),
        panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"), 
        panel.grid.minor = element_line(size = 0.5, linetype = 'solid', colour = "white"),
    axis.text.y = element_text(face = boldpattern3)) +
  scale_x_continuous(seq(-.3, .1, by = 0.1), labels = c("-.3", "-.2", "-.1", "0", ".1")) +
  scale_y_discrete(labels = y_labs3) +
  geom_point(size=1.75) +
  geom_vline(xintercept = 0, linetype="dotted", color = "red")
```

```{r display priming_charts, echo = FALSE, warning = FALSE, fig.height = 17, fig.width = 13}

# Use patchwork to display
priming_upper / priming_lower

```

\linespread{1}\selectfont

*Figure 2*: This is a replication of Figure 2 on page 87 of the original paper. The only difference to note is the omittance of parent political background and positioning differences. My replication switched the positions of PR Tier and SNTV Tier for the House of Councillors, and the positions of PR Tier and SMD Tier for the House of Representatives, as the `plot` function likely orders the facet grid alphabetically. Notably, the comparison graphs (the last ones on the right) do not show significant differences among groups that were primed with different information.

\linespread{2}\selectfont

## Extension



According to Leeper *et al.* (2019), a flaw with interpreting "differences in conditional AMCEs as differences in underlying preferences" exists because of how the subgroups that are being compared are chosen, and whether there are any meaningful *absolute* differences (@leeper). Finding the marginal means, then, are useful because there are no baseline values for comparison, but rather allows all variable levels to be compared in a relative sense. 



```{r mm, echo=FALSE, warning = FALSE}

# See above explanation for setting warning = FALSE.

# Calculate marginal means
DD_mm <- cj(DD,
            formula = Y.1 ~ Age + Experience + Education + Education + Hometown + Party + Previous_Occupation,
            estimate = "mm",
            level_order = c("descending"),
            by = ~Gender)

# Calculate marginal means differences
DD_mm_diff <- cj(DD,
              formula = Y.1 ~ Age + Experience + Education + Education + Hometown + Party + Previous_Occupation,
              estimate = "mm_differences",
              level_order = c("descending"),
              by = ~Gender)

# Subset data to grey out points
grey_mm_diff <- DD_mm_diff %>%
  filter(lower < 0 & upper > 0)

# Plot marginal means graph
mm_1 <- plot(DD_mm) +
  facet_wrap(~BY, ncol = 2L) +
  labs(title = "Marginal Means by Gender") +
  theme_minimal() +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.text = element_text(size=10),
        panel.background = element_rect(fill = "gray95",
                                        colour = "gray95",
                                        size = 2,
                                        linetype = "solid"),
        panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"), 
        panel.grid.minor = element_line(size = 0.5, linetype = 'solid', colour = "white"),
    axis.text.y = element_text(face = boldpattern)) +
    scale_y_discrete(labels = y_labs) +
    geom_point(size=1.6) +
  geom_vline(xintercept = 0.5, linetype="dotted", color = "red")

# Plot differences in mm graph
mm_2 <- plot(DD_mm_diff) +
  facet_wrap(~BY, ncol = 1L) +
  labs(title = "",
                caption = "Data from Horiuchi, Smith, & Yamamato via Dataverse") +
  theme_minimal() +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.text = element_text(size=10),
        panel.background = element_rect(fill = "gray95",
                                        colour = "gray95",
                                        size = 2,
                                        linetype = "solid"),
        panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"), 
        panel.grid.minor = element_line(size = 0.5, linetype = 'solid', colour = "white"),
    axis.text.y = element_blank()) +
    scale_y_discrete(labels = y_labs) +
    geom_point(size=1.75) +
    geom_point(data = grey_mm_diff, size = 1.75) +
    geom_errorbarh(data=grey_mm_diff, aes(xmin = lower, xmax = upper), color = 'grey', height = 0) +
  geom_vline(xintercept = 0, linetype="dotted", color = "red")

# Create character string to rename y axis.

y_labs2 <- rev(c("Age:", "42", "57", "64", "79",
            "Experience:",  "Formerly in office, 1 term", "Currently in office, 1 term", "Formerly in office, 2 terms", "Currently in office, 2 terms", "Formerly in office, 3+ terms", "Currently in office, 3+ terms",
            "Highest Educational Attainment:", "Local public university", "Prestigious private university", "University of Tokyo", 
            "Hometown:", "Outside",
            "Party:", "DPJ", "JCP", "Komeito", "LDP",
            "Prior Occupation:", "Business executive", "Celebrity", "Local government employee", "National government employee", "Prefectural assembly member", "Prefectural governor"))
```

```{r display_2, echo = FALSE, warning = FALSE, fig.width= 12, fig.height = 8.5}

# Refer to earlier chunk re: explanation for setting warning = FALSE.

# Display the plots using patchwork package
mm_1 + mm_2 + plot_layout(ncol = 2, widths = c(2, 1))
```

\linespread{1}\selectfont

*Figure 3*: The top graphic displays the marginal means graph for gender ACIEs, or the average marginal interaction effects (AMIEs). As you can see, notable differences between the genders include the effect of political experience. Interestingly, in the marginal means graph (we shall denote them as MM graphs), the baseline of "No experience" seems to punish men more so than women. This is interesting because women are more likely than men to be part of dynastic political families, and supports the notion that young first-timer female candidates hit a so-called "bamboo ceiling" as their political careers lengthen, according to Horiuchi *et al.* (@R-yamamoto). The only major difference between the AMCE differences and marginal means differences is in the Experience attribute. The original AMCE differences plot revealed that men were rewarded compared to women for being a current incumbent with 3+ terms of experience, at a significant level. However, the marginal means differences does not show a significant difference in this feature level, but a significant difference in the 'No experience' level.

```{r priming_mms, include = FALSE, cache = TRUE}

# Calculate MMs and differences for each of the HC and HR
upper_mm <- cj(upper,
            formula = Y.1 ~ Age + Experience + Gender + Education + Hometown + Party + Previous_Occupation,
            estimate = "mm",
            level_order = c("descending"),
            by = ~dist)

upper_mm_diff <- cj(upper,
              formula = Y.1 ~ Age + Experience + Gender + Education + Hometown + Party + Previous_Occupation,
              estimate = "mm_differences",
              level_order = c("descending"),
              by = ~dist)
lower_mm <- cj(lower,
            formula = Y.1 ~ Age + Experience + Gender + Education + Hometown + Party + Previous_Occupation,
            estimate = "mm",
            level_order = c("descending"),
            by = ~dist)

lower_mm_diff <- cj(lower,
              formula = Y.1 ~ Age + Experience + Gender + Education + Hometown + Party + Previous_Occupation,
              estimate = "mm_differences",
              level_order = c("descending"),
              by = ~dist)

priming_mm_upper <- plot(upper_mm) +
  ggplot2::facet_wrap(~BY, ncol = 2L) +
  ggplot2::labs(title = "Marginal means and differences for the House of Councillors") +
  theme_minimal() +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.text = element_text(size=10),
        panel.background = element_rect(fill = "gray95",
                                        colour = "gray95",
                                        size = 2,
                                        linetype = "solid"),
        panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"), 
        panel.grid.minor = element_line(size = 0.5, linetype = 'solid', colour = "white"),
    axis.text.y = element_text(face = boldpattern3)) +
  scale_y_discrete(labels = y_labs3) +
  geom_point(size=1.75) +
  geom_vline(data = upper_mm, xintercept = 0.5, linetype="dotted", color = "red")

priming_mm_diff_upper <- plot(upper_mm_diff) +
  facet_wrap(~BY, ncol = 1L) +
  ggplot2::labs(title = "") +
  theme_minimal() +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.text = element_text(size=10),
        panel.background = element_rect(fill = "gray95",
                                        colour = "gray95",
                                        size = 2,
                                        linetype = "solid"),
        panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"), 
        panel.grid.minor = element_line(size = 0.5, linetype = 'solid', colour = "white"),
    axis.text.y = element_blank()) +
  scale_y_discrete(labels = y_labs3) +
  geom_point(size=1.75) +
  geom_vline(xintercept = 0, linetype="dotted", color = "red")

priming_mm_lower <- plot(lower_mm) +
  ggplot2::facet_wrap(~BY, ncol = 2L) +
  ggplot2::labs(title = "Marginal means and differences for the House of Representatives") +
  theme_minimal() +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.text = element_text(size=10),
        panel.background = element_rect(fill = "gray95",
                                        colour = "gray95",
                                        size = 2,
                                        linetype = "solid"),
        panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"), 
        panel.grid.minor = element_line(size = 0.5, linetype = 'solid', colour = "white"),
    axis.text.y = element_text(face = boldpattern3)) +
  scale_y_discrete(labels = y_labs3) +
  geom_point(size=1.75) +
  geom_vline(data = upper_mm, xintercept = 0.5, linetype="dotted", color = "red")

priming_mm_diff_lower <- plot(lower_mm_diff) +
  facet_wrap(~BY, ncol = 1L) +
  ggplot2::labs(title = "",
                caption = "Data from Horiuchi, Smith, & Yamamato via Dataverse") +
  theme_minimal() +
  theme(legend.position = "none",
        axis.title.x = element_blank(),
        axis.text = element_text(size=10),
        panel.background = element_rect(fill = "gray95",
                                        colour = "gray95",
                                        size = 2,
                                        linetype = "solid"),
        panel.grid.major = element_line(size = 0.5, linetype = 'solid', colour = "white"), 
        panel.grid.minor = element_line(size = 0.5, linetype = 'solid', colour = "white"),
    axis.text.y = element_blank()) +
  scale_y_discrete(labels = y_labs3) +
  geom_point(size=1.75) +
  geom_vline(xintercept = 0, linetype="dotted", color = "red")
```

```{r display_priming_mm, echo = FALSE, warning = FALSE, fig.height = 17, fig.width = 13}

# Use patchwork to display
(priming_mm_upper + priming_mm_diff_upper + plot_layout(ncol = 2, widths = c(2,1))) / 
(priming_mm_lower + priming_mm_diff_lower + plot_layout(ncol = 2, widths = c(2,1)))

```

*Figure 4*: Displayed above is the marginal means plot for different priming groups. Consistent with Horiuchi, Smith, & Yamamoto's (2020) findings, there are not significant differences between priming groups. The only significant differences between the AMCE and marginal means plots are with the "Celebrity" feature level for prior occupation and the "42" feature level for age between the SMD and PR levels. 

\linespread{2}\selectfont

## Conclusion



Through this replication of Horiuchi, Smith, & Yamamoto's (2020) paper, I was able to replicate their main findings. There were significant voter preferences consistent across the treatment groups, all of which received different information about different electoral systems. Some of these observations include a preference for non-celebrity candidates, candidates from within the prefecture, and younger political candidates. There was no gender preference, all other attributes held equal. 



However, observational data contradicts these consistent preferences found in conjoint analyses; Japan has a persistently unequal parliamentary body. To make sense of this gap, the authors investigated the ACIE of specific variables, namely the gender variable. Importantly, they found that women received less of a reward in voters' eyes for having more experience, relative to their male counterparts. As such, Horiuchi, Smith, & Yamamoto (2020) looked at external explanations, such as party recruitment tactics, to account for the legislative gender inequality and gap between experimental and observational data.



My extension of the paper looked at marginal means and average marginal interaction effects instead of average marginal component effects and average component interaction effects. Through looking at the marginal means, I have found observations consistent with the original paper's and new significant points of interest, such as the reward for younger politicians in SMD tiers compared to PR tiers. Future steps would involve clarifying why the "Parent Political Background" variable was incompatible with the AMCE calculating function or what went wrong in my recoding of the variable, to provide a complete picture of the average marginal effects of candidate attributes on voter preferences.

## Appendix

Results from Horiuchi, Smith, & Yamamoto (2020) were successfully replicated. As an example, here is Figure A.1 from page 2 of the online Appendix.

```{r mosaic, echo = FALSE, fig.height = 3, fig.width = 3}

## gender (Fig A.1.a)
DD_lo$by <- DD_lo$gender_lab
DD_up$by <- DD_up$gender_lab
DD_lo_win$by <- DD_lo_win$gender_lab
DD_up_win$by <- DD_up_win$gender_lab

DD_lo_mosaic <- DD_lo %>%
  select(elec_type_2, by) %>%
  group_by(elec_type_2, by) %>%
  count()

# Mosaic plots by gender
gender_DD_lo <- ggplot(DD_lo) + 
  geom_mosaic(aes(x = product(elec_type_2), fill = by)) +
  theme_classic() +
  labs(title = "HR Candidates") +
  scale_y_continuous(breaks = seq(0, 1, by = 0.25),
                     labels = c("0.00", "0.25", "0.50", "0.75", "1.00")) +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.title = element_blank(),
        legend.box.margin = margin(),
        plot.title = element_text(hjust = 0.5),
        axis.line = element_blank())

gender_DD_up <- ggplot(DD_up) + 
  geom_mosaic(aes(x = product(elec_type_2), fill = by)) +
  theme_classic()+
  labs(title = "HC Candidates") +
  scale_y_continuous(breaks = seq(0, 1, by = 0.25),
                     labels = c("0.00", "0.25", "0.50", "0.75", "1.00")) +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.title = element_blank(),
        legend.box.margin = margin(),
        plot.title = element_text(hjust = 0.5),
        axis.line = element_blank())

gender_DD_lo_win <- ggplot(DD_lo_win) + 
  geom_mosaic(aes(x = product(win_type_1), fill = by)) +
  theme_classic() +
  labs(title = "HR Winners") +
  scale_y_continuous(breaks = seq(0, 1, by = 0.25),
                     labels = c("0.00", "0.25", "0.50", "0.75", "1.00")) +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.title = element_blank(),
        legend.box.margin = margin(),
        plot.title = element_text(hjust = 0.5),
        axis.line = element_blank())

gender_DD_up_win <- ggplot(DD_up_win) + 
  geom_mosaic(aes(x = product(elec_type_2), fill = by)) +
  theme_classic() +
  labs(title = "HC Winners") +
  scale_y_continuous(breaks = seq(0, 1, by = 0.25),
                     labels = c("0.00", "0.25", "0.50", "0.75", "1.00")) +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.title = element_blank(),
        legend.box.margin = margin(),
        plot.title = element_text(hjust = 0.5),
        axis.line = element_blank())

# Display the gender mosaic plots

gender_DD_lo
gender_DD_up
gender_DD_lo_win
gender_DD_up_win


# Mosaic plots by age
age_DD_lo <- ggplot(DD_lo) + 
  geom_mosaic(aes(x = product(elec_type_2), fill = age_lab)) +
  theme_classic() +
  labs(title = "HR Candidates") +
  scale_y_continuous(breaks = seq(0, 1, by = 0.25),
                     labels = c("0.00", "0.25", "0.50", "0.75", "1.00")) +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.title = element_blank(),
        legend.box.margin = margin(),
        plot.title = element_text(hjust = 0.5),
        axis.line = element_blank())

age_DD_up <- DD_up %>%
  mutate(elec_type_2 = factor(elec_type_2, levels = c("SNTV", "PR"))) %>%
  ggplot() + 
  geom_mosaic(aes(x = product(elec_type_2), fill = age_lab)) +
  theme_classic()+
  labs(title = "HC Candidates") +
  scale_y_continuous(breaks = seq(0, 1, by = 0.25),
                     labels = c("0.00", "0.25", "0.50", "0.75", "1.00")) +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.title = element_blank(),
        legend.box.margin = margin(),
        plot.title = element_text(hjust = 0.5),
        axis.line = element_blank())

age_DD_lo_win <- ggplot(DD_lo_win) + 
  geom_mosaic(aes(x = product(win_type_1), fill = age_lab)) +
  theme_classic() +
  labs(title = "HR Winners") +
  scale_y_continuous(breaks = seq(0, 1, by = 0.25),
                     labels = c("0.00", "0.25", "0.50", "0.75", "1.00")) +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.title = element_blank(),
        legend.box.margin = margin(),
        plot.title = element_text(hjust = 0.5),
        axis.line = element_blank())

age_DD_up_win <- DD_up_win %>%
  mutate(elec_type_2 = factor(elec_type_2, levels = c("SNTV", "PR"))) %>%
  ggplot() +
  geom_mosaic(aes(x = product(elec_type_2), fill = age_lab)) +
  theme_classic() +
  labs(title = "HC Winners") +
  scale_y_continuous(breaks = seq(0, 1, by = 0.25),
                     labels = c("0.00", "0.25", "0.50", "0.75", "1.00")) +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.title = element_blank(),
        legend.box.margin = margin(),
        plot.title = element_text(hjust = 0.5),
        axis.line = element_blank())

# Display the age-based mosaic plots

age_DD_lo
age_DD_up
age_DD_lo_win
age_DD_up_win
```

\linespread{1}\selectfont

*Figure 5*: The above eight mosaic plots subset by gender and age of real candidates that ran in 2013 and 2014 elections. HR represents House of Representatives, the lower chamber of Japanese parliament, whereas HC represents the House of Councillors, the upper chamber of Japanese parliament. The figures also compare the share of candidates that ran in SNTV (multi-member)/PR districts versus the proportion of winners from either district.

\pagebreak

## Bibliography
